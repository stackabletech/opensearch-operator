---
dimensions:
  - name: opensearch
    values:
      - 3.1.0
      # To use a custom image, add a comma and the full name after the product version, e.g.:
      # - 3.1.0,oci.stackable.tech/sandbox/opensearch:3.1.0-stackable0.0.0-dev
      # - 3.1.0,localhost:5000/sdp/opensearch:3.1.0-stackable0.0.0-dev
  - name: openshift
    values:
      - "false"
  - name: opensearch_home
    values:
      - /stackable/opensearch
tests:
  - name: smoke
    dimensions:
      - opensearch
      - openshift
      - opensearch_home
  - name: external-access
    dimensions:
      - opensearch
      - openshift
      - opensearch_home
  # requires an image with the OpenSearch Prometheus exporter
  - name: metrics
    dimensions:
      - opensearch
      - openshift
  - name: ldap
    dimensions:
      - opensearch
      - openshift
      - opensearch_home
  # requires an image with Vector
  - name: logging
    dimensions:
      - opensearch
      - openshift
suites:
  - name: nightly
    patch:
      - dimensions:
          - name: opensearch
            expr: last
  - name: smoke-latest
    select:
      - smoke
    patch:
      - dimensions:
          - expr: last
  - name: openshift
    patch:
      - dimensions:
          - expr: last
      - dimensions:
          - name: openshift
            expr: "true"
          - name: opensearch
            expr: last
  - name: original-image
    select:
      - smoke
      - external-access
      - ldap
    patch:
      - dimensions:
          - name: opensearch
            expr: 3.1.0,opensearchproject/opensearch:3.1.0
          - name: opensearch_home
            expr: /usr/share/opensearch
